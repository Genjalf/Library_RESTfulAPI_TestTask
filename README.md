# –ë–∏–±–ª–∏–æ—Ç–µ—á–Ω—ã–π REST API

##  –ö—Ä–∞—Ç–∫–æ–µ –æ–ø–∏—Å–∞–Ω–∏–µ

–ü—Ä–æ–µ–∫—Ç –ø—Ä–µ–¥—Å—Ç–∞–≤–ª—è–µ—Ç —Å–æ–±–æ–π REST API –¥–ª—è –±–∏–±–ª–∏–æ—Ç–µ–∫–∏, –ø–æ–∑–≤–æ–ª—è—é—â–∏–π:
- –£–ø—Ä–∞–≤–ª—è—Ç—å –∫–Ω–∏–≥–∞–º–∏, —á–∏—Ç–∞—Ç–µ–ª—è–º–∏ –∏ –±–∏–±–ª–∏–æ—Ç–µ–∫–∞—Ä—è–º–∏.
- –û—Å—É—â–µ—Å—Ç–≤–ª—è—Ç—å –≤—ã–¥–∞—á—É –∏ –≤–æ–∑–≤—Ä–∞—Ç –∫–Ω–∏–≥.
- –û–±–µ—Å–ø–µ—á–∏–≤–∞—Ç—å –∞—É—Ç–µ–Ω—Ç–∏—Ñ–∏–∫–∞—Ü–∏—é –±–∏–±–ª–∏–æ—Ç–µ–∫–∞—Ä–µ–π —á–µ—Ä–µ–∑ JWT.

##  –ò–Ω—Å—Ç—Ä—É–∫—Ü–∏—è –ø–æ –∑–∞–ø—É—Å–∫—É

1. –ö–ª–æ–Ω–∏—Ä—É–π—Ç–µ —Ä–µ–ø–æ–∑–∏—Ç–æ—Ä–∏–π –∏ –ø–µ—Ä–µ–π–¥–∏—Ç–µ –≤ –¥–∏—Ä–µ–∫—Ç–æ—Ä–∏—é –ø—Ä–æ–µ–∫—Ç–∞:

```bash
git clone <URL>
cd Library_restAPI
```

2. –£—Å—Ç–∞–Ω–æ–≤–∏—Ç–µ –∑–∞–≤–∏—Å–∏–º–æ—Å—Ç–∏:

```bash
pip install -r requirements.txt
```

3. –ó–∞–ø–æ–ª–Ω–∏—Ç–µ —Ñ–∞–π–ª `.env`:

```
DATABASE_URL=postgresql://<user>:<password>@localhost/<dbname>
SECRET_KEY=your_secret_key
ALGORITHM=HS256
ACCESS_TOKEN_EXPIRE_MINUTES=30
```

4. –ó–∞–ø—É—Å—Ç–∏—Ç–µ –º–∏–≥—Ä–∞—Ü–∏–∏ (–µ—Å–ª–∏ –∏—Å–ø–æ–ª—å–∑—É–µ—Ç—Å—è Alembic):

```bash
alembic upgrade head
```

5. –ó–∞–ø—É—Å—Ç–∏—Ç–µ —Å–µ—Ä–≤–µ—Ä:

```bash
uvicorn app.main:app --reload
```

6. –ü–µ—Ä–µ–π–¥–∏—Ç–µ –Ω–∞ [http://localhost:8000/docs](http://localhost:8000/docs) –¥–ª—è —Ä–∞–±–æ—Ç—ã —Å API.

7. –†–µ–≥–∏—Å—Ç—Ä–∞—Ü–∏—è –ø–µ—Ä–≤–æ–≥–æ –±–∏–±–ª–∏–æ—Ç–µ–∫–∞—Ä—è:

POST-–∑–∞–ø—Ä–æ—Å –Ω–∞ `/register` —Å —Ç–µ–ª–æ–º:
```json
{
  "email": "admin@example.com",
  "password": "yourpassword"
}
```

## üìÅ –°—Ç—Ä—É–∫—Ç—É—Ä–∞ –ø—Ä–æ–µ–∫—Ç–∞

```
Library_restAPI/
‚îú‚îÄ‚îÄ alembic/                # –º–∏–≥—Ä–∞—Ü–∏–∏ –ë–î
‚îú‚îÄ‚îÄ app/
‚îÇ   ‚îú‚îÄ‚îÄ api/                # —Ä–æ—É—Ç–µ—Ä—ã
‚îÇ   ‚îú‚îÄ‚îÄ auth.py             # JWT –∏ —Ö–µ—à–∏—Ä–æ–≤–∞–Ω–∏–µ
‚îÇ   ‚îú‚îÄ‚îÄ crud/               # –ª–æ–≥–∏–∫–∞ —Ä–∞–±–æ—Ç—ã —Å –º–æ–¥–µ–ª—è–º–∏
‚îÇ   ‚îú‚îÄ‚îÄ database.py         # –∫–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏—è –±–∞–∑—ã
‚îÇ   ‚îú‚îÄ‚îÄ dependencies.py     # –∑–∞–≤–∏—Å–∏–º–æ—Å—Ç–∏ FastAPI
‚îÇ   ‚îú‚îÄ‚îÄ main.py             # —Ç–æ—á–∫–∞ –≤—Ö–æ–¥–∞
‚îÇ   ‚îú‚îÄ‚îÄ models.py           # SQLAlchemy –º–æ–¥–µ–ª–∏
‚îÇ   ‚îú‚îÄ‚îÄ schemas.py          # Pydantic —Å—Ö–µ–º—ã
‚îÇ   ‚îî‚îÄ‚îÄ core/config.py      # –∫–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏–∏ –∏–∑ .env
‚îú‚îÄ‚îÄ .env
‚îú‚îÄ‚îÄ README.md
‚îî‚îÄ‚îÄ requirements.txt
```

##  –°—Ç—Ä—É–∫—Ç—É—Ä–∞ –±–∞–∑—ã –¥–∞–Ω–Ω—ã—Ö: –ø—Ä–∏–Ω—è—Ç—ã–µ —Ä–µ—à–µ–Ω–∏—è

- –¢–∞–±–ª–∏—Ü—ã: `users`, `books`, `readers`, `borrowed_books`.
- –¢–∞–±–ª–∏—Ü–∞ `borrowed_books` —Å–æ–¥–µ—Ä–∂–∏—Ç —Å–≤—è–∑–∏ `ForeignKey` —Å –∫–Ω–∏–≥–∞–º–∏, —á–∏—Ç–∞—Ç–µ–ª—è–º–∏ –∏ –±–∏–±–ª–∏–æ—Ç–µ–∫–∞—Ä—è–º–∏.
- –î–ª—è –∫–Ω–∏–≥–∏ —É—á–∏—Ç—ã–≤–∞–µ—Ç—Å—è –∫–æ–ª–∏—á–µ—Å—Ç–≤–æ –∫–æ–ø–∏–π. –í—ã–¥–∞—á–∞ –≤–æ–∑–º–æ–∂–Ω–∞ —Ç–æ–ª—å–∫–æ –ø—Ä–∏ –Ω–∞–ª–∏—á–∏–∏.
- –£ —á–∏—Ç–∞—Ç–µ–ª—è –º–æ–∂–µ—Ç –±—ã—Ç—å –Ω–µ –±–æ–ª–µ–µ 3 –≤—ã–¥–∞–Ω–Ω—ã—Ö –∫–Ω–∏–≥ –æ–¥–Ω–æ–≤—Ä–µ–º–µ–Ω–Ω–æ.

##  –†–µ–∞–ª–∏–∑–∞—Ü–∏—è –±–∏–∑–Ω–µ—Å-–ª–æ–≥–∏–∫–∏ (–ø—É–Ω–∫—Ç—ã 4.1, 4.2, 4.3)

### 4.1. –ü—Ä–æ–≤–µ—Ä–∫–∞ –¥–æ—Å—Ç—É–ø–Ω–æ—Å—Ç–∏ —ç–∫–∑–µ–º–ø–ª—è—Ä–æ–≤

–ü—Ä–∏ –≤—ã–¥–∞—á–µ –∫–Ω–∏–≥–∏ –ø—Ä–æ–≤–µ—Ä—è–µ—Ç—Å—è –ø–æ–ª–µ `copies`. –ï—Å–ª–∏ `copies <= 0`, –≤—ã–±—Ä–∞—Å—ã–≤–∞–µ—Ç—Å—è –æ—à–∏–±–∫–∞ `400`.

### 4.2. –û–≥—Ä–∞–Ω–∏—á–µ–Ω–∏–µ –Ω–∞ –∫–æ–ª–∏—á–µ—Å—Ç–≤–æ –∫–Ω–∏–≥ —É —á–∏—Ç–∞—Ç–µ–ª—è

–í —Ñ—É–Ω–∫—Ü–∏–∏ `issue_book` –ø—Ä–æ–≤–µ—Ä—è–µ—Ç—Å—è –∫–æ–ª–∏—á–µ—Å—Ç–≤–æ –Ω–µ–≤–æ–∑–≤—Ä–∞—â–µ–Ω–Ω—ã—Ö –∫–Ω–∏–≥ —É —á–∏—Ç–∞—Ç–µ–ª—è —á–µ—Ä–µ–∑ –æ—Ç–¥–µ–ª—å–Ω—ã–π –∑–∞–ø—Ä–æ—Å. –ï—Å–ª–∏ –∫–Ω–∏–≥ ‚â• 3 ‚Äî –≤—ã–¥–∞—á–∞ –±–ª–æ–∫–∏—Ä—É–µ—Ç—Å—è.

### 4.3. –í–æ–∑–≤—Ä–∞—Ç –∫–Ω–∏–≥

–ü—Ä–∏ –≤–æ–∑–≤—Ä–∞—Ç–µ:
- –û–±–Ω–æ–≤–ª—è–µ—Ç—Å—è –ø–æ–ª–µ `return_date`.
- –£–≤–µ–ª–∏—á–∏–≤–∞–µ—Ç—Å—è `copies` –∫–Ω–∏–≥–∏ –Ω–∞ 1.
- –ü—Ä–æ–≤–µ—Ä—è–µ—Ç—Å—è, –Ω–µ –±—ã–ª–∞ –ª–∏ —É–∂–µ –≤–æ–∑–≤—Ä–∞—â–µ–Ω–∞ –∫–Ω–∏–≥–∞, —á—Ç–æ–±—ã –∏–∑–±–µ–∂–∞—Ç—å –¥–≤–æ–π–Ω–æ–≥–æ –≤–æ–∑–≤—Ä–∞—Ç–∞.

### –°–ª–æ–∂–Ω–æ—Å—Ç–∏:
- –û–±—Ä–∞–±–æ—Ç–∫–∞ –ª–æ–≥–∏–∫–∏ –≤–æ–∑–≤—Ä–∞—Ç–∞ –∏ –ø—Ä–æ–≤–µ—Ä–∫–∞, –¥–µ–π—Å—Ç–≤–∏—Ç–µ–ª—å–Ω–æ –ª–∏ –∫–Ω–∏–≥–∞ –±—ã–ª–∞ –≤—ã–¥–∞–Ω–∞ –¥–∞–Ω–Ω–æ–º—É —á–∏—Ç–∞—Ç–µ–ª—é, —Ç—Ä–µ–±–æ–≤–∞–ª–∏ –∞–∫–∫—É—Ä–∞—Ç–Ω—ã—Ö –ø—Ä–æ–≤–µ—Ä–æ–∫.
- –ß—Ç–æ–±—ã –∏–∑–±–µ–∂–∞—Ç—å –æ—à–∏–±–æ–∫, –≤—Å—è –ª–æ–≥–∏–∫–∞ –¥–µ–ª–∏—Ç—Å—è: CRUD ‚Äî —Ç–æ–ª—å–∫–æ —Ä–∞–±–æ—Ç–∞ —Å –ë–î, –ø—Ä–æ–≤–µ—Ä–∫–∏ –∏ –æ—à–∏–±–∫–∏ ‚Äî –≤ —ç–Ω–¥–ø–æ–∏–Ω—Ç–∞—Ö.

##  –ê—É—Ç–µ–Ω—Ç–∏—Ñ–∏–∫–∞—Ü–∏—è

- –ò—Å–ø–æ–ª—å–∑—É–µ—Ç—Å—è JWT (–±–∏–±–ª–∏–æ—Ç–µ–∫–∞ `python-jose`) –∏ —Ö–µ—à–∏—Ä–æ–≤–∞–Ω–∏–µ –ø–∞—Ä–æ–ª–µ–π (`passlib[bcrypt]`).
- –¢–æ–∫–µ–Ω —Å–æ–∑–¥–∞—ë—Ç—Å—è –ø—Ä–∏ –ª–æ–≥–∏–Ω–µ –∏ —Å–æ–¥–µ—Ä–∂–∏—Ç email –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è.
- –î–ª—è –ø–æ–ª—É—á–µ–Ω–∏—è —Ç–æ–∫–µ–Ω–∞ –æ—Ç–ø—Ä–∞–≤–ª—è–µ—Ç—Å—è POST-–∑–∞–ø—Ä–æ—Å –Ω–∞ `/login`.
- –í—Å–µ —ç–Ω–¥–ø–æ–∏–Ω—Ç—ã, –∫—Ä–æ–º–µ `/login` –∏ `/register`, –∑–∞—â–∏—â–µ–Ω—ã –∏ —Ç—Ä–µ–±—É—é—Ç JWT —Ç–æ–∫–µ–Ω —á–µ—Ä–µ–∑ –∑–∞–≥–æ–ª–æ–≤–æ–∫ `Authorization: Bearer <—Ç–æ–∫–µ–Ω>`.
- –¢–æ–∫–µ–Ω –ø—Ä–æ–≤–µ—Ä—è–µ—Ç—Å—è –≤ –∑–∞–≤–∏—Å–∏–º–æ—Å—Ç–∏ `get_current_user`.

##  –ò–¥–µ—è –¥–ª—è –¥–æ–ø–æ–ª–Ω–∏—Ç–µ–ª—å–Ω–æ–π —Ñ–∏—á–∏

–î–æ–±–∞–≤–∏—Ç—å —Ä–µ–π—Ç–∏–Ω–≥ –∫–Ω–∏–≥: —á–∏—Ç–∞—Ç–µ–ª—å –ø–æ—Å–ª–µ –≤–æ–∑–≤—Ä–∞—Ç–∞ –∫–Ω–∏–≥–∏ –º–æ–∂–µ—Ç –æ—Å—Ç–∞–≤–∏—Ç—å –æ—Ü–µ–Ω–∫—É (1‚Äì5). –î–ª—è —Ä–µ–∞–ª–∏–∑–∞—Ü–∏–∏:
- –°–æ–∑–¥–∞—Ç—å —Ç–∞–±–ª–∏—Ü—É `book_ratings` —Å –ø–æ–ª—è–º–∏ `reader_id`, `book_id`, `rating`.
- –î–æ–±–∞–≤–∏—Ç—å —ç–Ω–¥–ø–æ–∏–Ω—Ç –¥–ª—è –æ—Ü–µ–Ω–∫–∏ –∫–Ω–∏–≥–∏.
- –í –æ—Ç–≤–µ—Ç–∞—Ö –ø–æ –∫–Ω–∏–≥–∞–º –≤—ã–≤–æ–¥–∏—Ç—å —Å—Ä–µ–¥–Ω–∏–π —Ä–µ–π—Ç–∏–Ω–≥.